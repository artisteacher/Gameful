function go_update_bonus_loot(){jQuery("#go_bonus_loot").html('<span class="go_loading"></span>');var e=GO_EVERY_PAGE_DATA.nonces.go_update_bonus_loot,t=go_task_data.ID;jQuery.ajax({type:"post",url:MyAjax.ajaxurl,data:{_ajax_nonce:e,action:"go_update_bonus_loot",post_id:t},error:function(e,t,o){400===e.status&&jQuery(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}])},success:function(e){console.log("Bonus Loot"),console.log(e),jQuery("#go_bonus_loot").remove(),jQuery("#go_wrapper").append(e)}})}function getTimeRemaining(e){var t=e-Date.parse(new Date),o=Math.floor(t/1e3%60),r=Math.floor(t/1e3/60%60),s=Math.floor(t/36e5%24),a;return{total:t,days:Math.floor(t/864e5),hours:s,minutes:r,seconds:o}}function initializeClock(e,t){function o(){var e=getTimeRemaining(t),o;(e.days=Math.max(0,e.days),s.innerHTML=e.days,e.hours=Math.max(0,e.hours),a.innerHTML=("0"+e.hours).slice(-2),e.minutes=Math.max(0,e.minutes),n.innerHTML=("0"+e.minutes).slice(-2),e.seconds=Math.max(0,e.seconds),i.innerHTML=("0"+e.seconds).slice(-2),e.total=0)&&(clearInterval(c),new Audio(PluginDir.url+"media/sounds/airhorn.mp3").play())}console.log("initializeClock"),t+=Date.parse(new Date);var r=document.getElementById(e),s=r.querySelector(".days"),a=r.querySelector(".hours"),n=r.querySelector(".minutes"),i=r.querySelector(".seconds");o();var l=getTimeRemaining(t),_=l.total;if(console.log("total"+l.total),_>0)var c=setInterval(o,1e3)}function go_timer_abandon(){var e=go_task_data.redirectURL;window.location=e}function flash_error_msg(e){var t=jQuery(e).css("background-color");void 0===typeof t&&(t="white"),jQuery(e).animate({color:t},200,function(){jQuery(e).animate({color:"red"},200)})}function task_stage_change(e){console.log("change");var t="";void 0!==jQuery(e).attr("button_type")&&(t=jQuery(e).attr("button_type")),console.log("Button:"+t);var o="";void 0!==jQuery(e).attr("status")&&(o=jQuery(e).attr("status"));var r="";void 0!==jQuery(e).attr("next_bonus")&&(r=jQuery(e).attr("next_bonus"));let s="";void 0!==jQuery(e).attr("check_type")&&(s=jQuery(e).attr("check_type"));let a="";void 0!==jQuery(e).attr("blog_post_id")&&(a=jQuery(e).attr("blog_post_id"));let n=jQuery("#go_result").attr("value"),i=null;if("blog"==s&&"undo_last_bonus"!=t)n=tinyMCE.activeEditor.getContent(),i=jQuery("#go_blog_title").html();else{let e=null}const l=go_get_blog_required_elements();console.log("required_elements"),console.log(l);const _=JSON.stringify(l);console.log(_),jQuery.ajax({type:"POST",data:{_ajax_nonce:go_task_data.go_task_change_stage,action:"go_task_change_stage",post_id:go_task_data.ID,user_id:go_task_data.userID,status:o,next_bonus:r,button_type:t,check_type:s,result:n,result_title:i,blog_post_id:a,required_elements:_},error:function(e,t,o){go_disable_loading(),400===e.status&&jQuery(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}])},success:function(e){console.log(e),"login"==e&&jQuery(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}]),"refresh"===e&&Swal.fire({title:"Error",text:"Refresh the page and then try again? You will lose unsaved changes. You can cancel and copy any unsaved changes to a safe location before refresh.",type:"warning",confirmButtonText:"Refresh Now",reverseButtons:!0,customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"}}).then(e=>{e.value&&location.reload()});var t={};try{var t=JSON.parse(e)}catch(e){t={json_status:"101",timer_start:"",button_type:"",time_left:"",html:"",redirect:"",rewards:{gold:0}}}if("101"===Number.parseInt(t.json_status)){console.log(101),jQuery("#go_stage_error_msg").show();var o="Server Error.";jQuery("#go_stage_error_msg").text()!=o?jQuery("#go_stage_error_msg").text(o):flash_error_msg("#go_stage_error_msg")}else if(302===Number.parseInt(t.json_status))console.log(302),window.location=t.location;else if("refresh"==t.json_status)location.reload();else if("bad_password"==t.json_status){jQuery("#go_stage_error_msg").show();var o="Invalid password.";jQuery("#go_stage_error_msg").text()!=o?jQuery("#go_stage_error_msg").text(o):flash_error_msg("#go_stage_error_msg"),go_disable_loading()}else{if("undo"==t.button_type)jQuery("#go_wrapper div").last().hide(),jQuery("#go_wrapper > div").slice(-3).hide("slow",function(){jQuery(this).remove()});else if("undo_last"==t.button_type)jQuery("#go_wrapper div").last().hide(),jQuery("#go_wrapper > div").slice(-2).hide("slow",function(){jQuery(this).remove()});else if("continue"==t.button_type||"complete"==t.button_type)jQuery("#go_wrapper > div").slice(-1).hide("slow",function(){jQuery(this).remove()});else if("show_bonus"==t.button_type)jQuery("#go_buttons").remove(),jQuery(".go_checks_and_buttons").removeClass("active");else if("continue_bonus"==t.button_type||"complete_bonus"==t.button_type)jQuery("#go_wrapper > div").slice(-1).hide("slow",function(){jQuery(this).remove()});else if("undo_bonus"==t.button_type)jQuery("#go_wrapper > div").slice(-2).hide("slow",function(){jQuery(this).remove()});else if("undo_last_bonus"==t.button_type)jQuery("#go_wrapper > div").slice(-1).hide("slow",function(){jQuery(this).remove()});else if("abandon_bonus"==t.button_type)jQuery("#go_wrapper > div").slice(-3).remove();else if("abandon"==t.button_type)window.location=t.redirect;else if("timer"==t.button_type){var r;jQuery("#go_wrapper > div").slice(-2).hide("slow",function(){jQuery(this).remove()}),new Audio(PluginDir.url+"media/sounds/airhorn.mp3").play()}go_append(t),jQuery(document).ready(function(){jQuery(".feedback_accordion").accordion({collapsible:!0,active:!1})})}}})}function go_mce_reset(){tinymce.execCommand("mceRemoveEditor",!0,"go_blog_post"),tinymce.execCommand("mceAddEditor",!0,"go_blog_post")}function go_append(e){console.log("go_append");var t=e.html;console.log("html"),console.log(t),jQuery(e.html).appendTo("#go_wrapper").stop().hide().show("slow").promise().then(function(){console.log("here"),go_Vids_Fit_and_Box("body"),console.log("here2"),go_make_clickable(),console.log("here3"),go_disable_loading(),console.log("here4");var e="go_blog_post";tinymce.execCommand("mceRemoveEditor",!0,e),quicktags({id:e}),tinymce.init({selector:e,branding:!1,theme:"modern",skin:"lightgray",language:"en",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img,table,dl.wp-caption",classes:"alignleft"}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img,table,dl.wp-caption",classes:"aligncenter"}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img,table,dl.wp-caption",classes:"alignright"}],strikethrough:{inline:"del"}},relative_urls:!1,remove_script_host:!1,convert_urls:!1,browser_spellcheck:!0,fix_list_elements:!0,entities:"38,amp,60,lt,62,gt",entity_encoding:"raw",keep_styles:!1,paste_webkit_styles:"font-weight font-style color",preview_styles:"font-family font-size font-weight font-style text-decoration text-transform",wpeditimage_disable_captions:!1,wpeditimage_html5_captions:!0,plugins:"charmap,hr,lists,media,paste,tabfocus,textcolor,fullscreen,wordpress,wpeditimage,wpgallery,wplink,wpdialogs,wpview,wordcount",selector:"#"+e,resize:"vertical",menubar:!1,wpautop:!0,wordpress_adv_hidden:!1,indent:!1,toolbar1:"formatselect,bold,italic,bullist,numlist,blockquote,alignleft,aligncenter,alignright,link,wp_more,spellchecker,fullscreen,wp_adv",toolbar2:"strikethrough,hr,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help",toolbar3:"",toolbar4:"",tabfocus_elements:":prev,:next",body_class:"id post-type-post post-status-publish post-format-standard"}),tinyMCE.execCommand("mceAddEditor",!1,e)})}function go_make_clickable(){jQuery(".clickable").keyup(function(e){13===e.which&&jQuery("#go_button").click()})}function go_update_admin_view(e){jQuery.ajax({type:"POST",url:MyAjax.ajaxurl,data:{_ajax_nonce:GO_EVERY_PAGE_DATA.nonces.go_update_admin_view,action:"go_update_admin_view",go_admin_view:e},error:function(e,t,o){400===e.status&&jQuery(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}])},success:function(e){location.reload()}})}function go_quiz_check_answers(e,t){for(var o=jQuery(t).closest(".go_checks_and_buttons").find(" .go_test_list"),r=o.length,s=[],a=[],n=0;n<r;n++){console.log("Question "+n);var i=o[n].children[1].children[0].type;s.push(i);var l="#"+o[n].id+" :checked",_="#"+o[n].id+" input:not(:checked)",c=jQuery(l),u=jQuery(_);if(console.log("chosen_answers: "+c),console.log(c),console.log("chosen_answers length: "+c.length),console.log("not_chosen_answers: "+u),console.log(u),console.log("not_chosen_answers length: "+u.length),"radio"==i)console.log("test_type :"+i),null!=c[0]&&a.push(c[0].value);else if("checkbox"==i){for(var g=[],d=0;d<c.length;d++)g.push(c[d].value);a.push(g)}for(var d=0;d<c.length;d++)jQuery(c[d]).addClass("go_quiz_checked");for(var d=0;d<u.length;d++)jQuery(u[d]).removeClass("go_quiz_checked")}var h=a,p=s;jQuery.ajax({type:"POST",data:{_ajax_nonce:go_task_data.go_check_quiz_answers,action:"go_check_quiz_answers",task_id:go_task_data.ID,user_id:go_task_data.userID,list_size:r,chosen_answer:h,type:p,status:e},error:function(e,t,o){400===e.status&&jQuery(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}])},success:function(r){if("login"===r&&jQuery(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}]),"refresh"==r)location.reload();else if(1==r){var s="#go_test_container_"+(parseFloat(e)+1);console.log("All Correct"),console.log("container_id: "+s),jQuery(".go_test_container").hide("slow"),jQuery("#test_failure_msg").hide("slow"),jQuery(".go_test_submit_div").hide("slow"),jQuery(s+" .go_wrong_answer_marker").hide(),jQuery(s+" .go_correct_answer_marker").show(),jQuery("#go_stage_error_msg").hide(),go_send_save_quiz_result(t,e,function(){task_stage_change(t)}),go_disable_loading()}else if("string"==typeof r){for(var a=JSON.parse(r),n=0;n<o.length;n++){var i=o[n].id;-1===jQuery.inArray(i,a)?(console.log("correct"),jQuery("#"+i+" .go_wrong_answer_marker").hide(),jQuery("#"+i+" .go_correct_answer_marker").show()):(jQuery("#"+i+" .go_correct_answer_marker").hide(),jQuery("#"+i+" .go_wrong_answer_marker").show())}var l;"Try again!"!=jQuery("#go_stage_error_msg").text()?(jQuery(".go_error_msg").show(),jQuery(".go_error_msg").text("Try again!")):flash_error_msg("#go_stage_error_msg"),go_send_save_quiz_result(t,e,function(){}),go_disable_loading()}}})}function go_send_save_quiz_result(e,t,o){var r=jQuery(e).closest(".go_checks_and_buttons").find(" .go_test_container"),s=jQuery(r).clone();jQuery(s).find("input").prop("disabled",!0),jQuery(s).find(".go_quiz_checked").attr("checked","checked");var a=["type","checked","disabled"];jQuery(s).find("input").each(function(){for(var e=this.attributes,t=e.length;t--;){var o=e[t];-1==jQuery.inArray(o.name,a)&&this.removeAttributeNode(o)}});var n=jQuery(s).html();console.log("Quiz HTML: "+n),jQuery.ajax({type:"POST",data:{_ajax_nonce:go_task_data.go_save_quiz_result,action:"go_save_quiz_result",html:n,task_id:go_task_data.ID,user_id:go_task_data.userID,status:t},error:function(e,t,o){400===e.status&&jQuery(document).trigger("heartbeat-tick.wp-auth-check",[{"wp-auth-check":!1}])},success:function(){o()}})}jQuery(document).ready(function(){jQuery(".go_quiz_checked").prop("checked",!0),jQuery.ajaxSetup({url:go_task_data.url+="/wp-admin/admin-ajax.php"}),go_make_clickable(),jQuery(".go_stage_message").show();var e=jQuery("#go_select_admin_view").val();console.log(e),"all"!=e&&(jQuery("#go_button").one("click",function(e){task_stage_check_input(this,!0)}),jQuery("#go_back_button").one("click",function(e){task_stage_change(this)}),jQuery("#go_save_button").one("click",function(e){go_blog_submit(this,!1)})),jQuery("#go_bonus_button").one("click",function(e){go_update_bonus_loot(this)}),jQuery(".progress").closest(".go_checks_and_buttons").addClass("active"),jQuery("#go_admin_override").appendTo(".go_locks"),jQuery("#go_admin_override").click(function(){jQuery(".go_password").show(),jQuery(".go_password #go_result").focus()})});